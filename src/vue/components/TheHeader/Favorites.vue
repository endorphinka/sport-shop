<template>
  <router-link to="/favorites" class="header-btns-like">
    <div class="header-btns-like-ico">
      <svg width="26" height="22" viewBox="0 0 26 22" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M23.8333 6.70312C23.8333 5.92969 23.7307 5.24696 23.5254 4.65495C23.3201 4.06293 23.0575 3.59266 22.7376 3.24414C22.4178 2.89562 22.0286 2.61155 21.5703 2.39193C21.112 2.17231 20.6632 2.02431 20.224 1.94792C19.7847 1.87153 19.3168 1.83333 18.8203 1.83333C18.3238 1.83333 17.7891 1.95508 17.2161 2.19857C16.6432 2.44206 16.1157 2.74761 15.6335 3.11523C15.1513 3.48286 14.7383 3.82661 14.3945 4.14648C14.0508 4.46636 13.7643 4.75998 13.5352 5.02734C13.3633 5.23741 13.1293 5.34245 12.8333 5.34245C12.5373 5.34245 12.3034 5.23741 12.1315 5.02734C11.9023 4.75998 11.6159 4.46636 11.2721 4.14648C10.9284 3.82661 10.5154 3.48286 10.0332 3.11523C9.551 2.74761 9.02344 2.44206 8.45052 2.19857C7.87761 1.95508 7.34288 1.83333 6.84636 1.83333C6.34983 1.83333 5.88195 1.87153 5.44271 1.94792C5.00347 2.02431 4.55469 2.17231 4.09635 2.39193C3.63802 2.61155 3.24892 2.89562 2.92904 3.24414C2.60916 3.59266 2.34657 4.06293 2.14128 4.65495C1.93598 5.24696 1.83333 5.92969 1.83333 6.70312C1.83333 8.30729 2.72613 10.0022 4.51172 11.7878L12.8333 19.8086L21.1406 11.8021C22.9358 10.0069 23.8333 8.30729 23.8333 6.70312ZM25.6667 6.70312C25.6667 8.81337 24.5734 10.9618 22.3867 13.1484L13.4635 21.7422C13.2917 21.9141 13.0816 22 12.8333 22C12.5851 22 12.375 21.9141 12.2031 21.7422L3.26563 13.1198C3.17014 13.0434 3.03885 12.9193 2.87175 12.7474C2.70464 12.5755 2.43967 12.2628 2.07682 11.8092C1.71398 11.3557 1.38932 10.8902 1.10286 10.4128C0.816406 9.93533 0.560981 9.35764 0.336589 8.67969C0.112196 8.00174 0 7.34288 0 6.70312C0 4.60243 0.606337 2.96007 1.81901 1.77604C3.03168 0.592014 4.70747 0 6.84636 0C7.43837 0 8.04232 0.102648 8.6582 0.307943C9.27409 0.513238 9.84701 0.790148 10.377 1.13867C10.9069 1.4872 11.3628 1.81424 11.7448 2.11979C12.1267 2.42535 12.4896 2.75 12.8333 3.09375C13.1771 2.75 13.5399 2.42535 13.9219 2.11979C14.3038 1.81424 14.7598 1.4872 15.2897 1.13867C15.8197 0.790148 16.3926 0.513238 17.0085 0.307943C17.6244 0.102648 18.2283 0 18.8203 0C20.9592 0 22.635 0.592014 23.8477 1.77604C25.0603 2.96007 25.6667 4.60243 25.6667 6.70312Z" />
      </svg>
    </div>
    <div class="header-btns-like-count" v-if="count">
      {{ count }}
    </div>
  </router-link>
</template>

<script>
import { Fav } from 'src/js/utils/fav'
import { events } from 'src/main'

export default {
  name: 'Favorites',

  data: () => ({
    count: 0,
    items: []
  }),

  mounted () {
    this.setData()
    this.watch()
  },

  methods: {
    onDelete (item) {
      Fav.delete(item)
      events.$emit('fav:delete')
    },
    setData () {
      let { count } = Fav.summ()
      let items = Fav.get()

      this.count = count
      this.items = items
    },
    watch () {
      events.$on('fav:add', () => this.setData())
      events.$on('fav:delete', () => this.setData())
    }
  }
}
</script>

<style lang="scss">
  .header-btns-like {
    position: relative;

    cursor: pointer;

    transition: 0.1s ease-out;

    &:hover {
      opacity: .7;
    }

    %count-style {
      position: absolute;
      top: -19px;
      right: -15px;

      width: 19px;
      height: 19px;

      display: flex;
      align-items: center;
      justify-content: center;

      font-weight: bold;
      font-size: 13px;
      line-height: 13px;
      color: white;

      background-color: #F48221;
      border-radius: 50%;
    }

    &-count {
      @extend %count-style;
    }
  }
</style>
